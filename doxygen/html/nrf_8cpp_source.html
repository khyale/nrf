<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>nrf: nrf.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Gerado por Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Localizar');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&nbsp;principal</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Ficheiros</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Localizar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Lista&nbsp;de&nbsp;ficheiros</span></a></li>
      <li><a href="globals.html"><span>Ficheiros&nbsp;membro</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>nrf.cpp</h1>  </div>
</div>
<div class="contents">
<a href="nrf_8cpp.html">Ir para a documentação deste ficheiro.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;<a class="code" href="nrf_8h.html" title="Arquivo de definições da classe.">nrf.h</a>&quot;</span>
<a name="l00010"></a>00010 
<a name="l00019"></a><a class="code" href="classnrf.html#a2c8892435262e4e586346ab1642cfb23">00019</a> <a class="code" href="classnrf.html#a2c8892435262e4e586346ab1642cfb23" title="Construtor da classe.">nrf::nrf</a>(uint8_t ce, uint8_t csn){
<a name="l00020"></a>00020     <a class="code" href="classnrf.html#a65df277c87190fb9ec66f4855edf61d5">nrf::_ce</a> = ce;
<a name="l00021"></a>00021     <a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">nrf::_csn</a> = csn;
<a name="l00022"></a>00022     
<a name="l00023"></a>00023     pinMode(<a class="code" href="classnrf.html#a65df277c87190fb9ec66f4855edf61d5">_ce</a>, OUTPUT);   <span class="comment">// setup ce pin</span>
<a name="l00024"></a>00024     <a class="code" href="classnrf.html#a0093820dc7978c8cb33ea250e8847705" title="Desabilita o dispositivo.">nrf::chip_disable</a>();    <span class="comment">// chip no modo &#39;POWER_DOWN&#39;</span>
<a name="l00025"></a>00025                             <span class="comment">// após o &#39;power on reset&#39;</span>
<a name="l00026"></a>00026         
<a name="l00027"></a>00027     <a class="code" href="spidrv_8cpp.html#a14fbc64c3ff224793c68845edec8c826" title="Configura e inicia interface SPI.">spi_begin</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>);    <span class="comment">// configura e inicia a interface SPI</span>
<a name="l00028"></a>00028     
<a name="l00029"></a>00029     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>,<a class="code" href="nordic_8h.html#aece57618cf42f6b1b520341ef19a66f8">EN_CRC</a>); <span class="comment">// bits PWR_UP=0 e PRIM_RX=0</span>
<a name="l00030"></a>00030     <a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> = NRF_POWER_DOWN;
<a name="l00031"></a>00031     <a class="code" href="classnrf.html#a507bd00d0183aaca131e672fdeabf073">_last_mode</a> = <a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a>;
<a name="l00032"></a>00032     
<a name="l00033"></a>00033     delay(100);  <span class="comment">// assegura atraso no &#39;power on reset&#39;</span>
<a name="l00034"></a>00034     
<a name="l00035"></a>00035     <a class="code" href="classnrf.html#a674251450acee6d20090741155f793fa" title="Descarrega buffer de recepção.">nrf::flush_rx_fifo</a>();   <span class="comment">// limpa buffer de recepção</span>
<a name="l00036"></a>00036     <a class="code" href="classnrf.html#a89449d9aadc1957b3f6631780822f8be" title="Descarrega buffer de transmissão.">nrf::flush_tx_fifo</a>();   <span class="comment">// limpa buffer de transmissão</span>
<a name="l00037"></a>00037     <a class="code" href="classnrf.html#a08d4decf99a5cc9f04697ec0b8cad1c3" title="Limpa todos os flags de interrupção.">nrf::clear_all_int_flags</a>(); <span class="comment">// limpa flags de interrupção</span>
<a name="l00038"></a>00038 }
<a name="l00039"></a>00039 
<a name="l00045"></a><a class="code" href="classnrf.html#a27c13335cdcd46659337e232f97f663c">00045</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a27c13335cdcd46659337e232f97f663c" title="Habilita o dispositivo.">nrf::chip_enable</a>(<span class="keywordtype">void</span>){
<a name="l00046"></a>00046     digitalWrite(<a class="code" href="classnrf.html#a65df277c87190fb9ec66f4855edf61d5">_ce</a>,HIGH);
<a name="l00047"></a>00047 }
<a name="l00048"></a>00048 
<a name="l00055"></a><a class="code" href="classnrf.html#a0093820dc7978c8cb33ea250e8847705">00055</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a0093820dc7978c8cb33ea250e8847705" title="Desabilita o dispositivo.">nrf::chip_disable</a>(<span class="keywordtype">void</span>){
<a name="l00056"></a>00056     digitalWrite(<a class="code" href="classnrf.html#a65df277c87190fb9ec66f4855edf61d5">_ce</a>,LOW);
<a name="l00057"></a>00057 }
<a name="l00058"></a>00058 
<a name="l00070"></a><a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59">00070</a> uint8_t <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(uint8_t register_addr, uint8_t data){
<a name="l00071"></a>00071     uint8_t buff[2];
<a name="l00072"></a>00072     buff[0] = <a class="code" href="nordic_8h.html#a3b68b214d5753039d2c156ad57cd7153">W_REGISTER</a> | (register_addr &amp; 0x1F);
<a name="l00073"></a>00073     buff[1]=data; 
<a name="l00074"></a>00074     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>, buff, <span class="keyword">sizeof</span>(buff));
<a name="l00075"></a>00075     <span class="keywordflow">return</span> buff[0]; <span class="comment">//retorna estado</span>
<a name="l00076"></a>00076 }
<a name="l00077"></a>00077 
<a name="l00090"></a><a class="code" href="classnrf.html#abbed07bbeb60fb2090f2ffba58fab16b">00090</a> uint8_t <a class="code" href="classnrf.html#abbed07bbeb60fb2090f2ffba58fab16b" title="Escreve um bloco de dados no registrador.">nrf::spi_write_multibyte_register</a>(uint8_t register_addr, uint8_t *buff, uint8_t length){
<a name="l00091"></a>00091     uint8_t tmp[length+1];
<a name="l00092"></a>00092     tmp[0]= <a class="code" href="nordic_8h.html#a3b68b214d5753039d2c156ad57cd7153">W_REGISTER</a> | (register_addr &amp; 0x1F);
<a name="l00093"></a>00093     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;length;i++)
<a name="l00094"></a>00094         tmp[i+1]=*buff++; 
<a name="l00095"></a>00095     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>, tmp, <span class="keyword">sizeof</span>(tmp));
<a name="l00096"></a>00096     <span class="keywordflow">return</span> tmp[0];
<a name="l00097"></a>00097 }  
<a name="l00098"></a>00098 
<a name="l00110"></a><a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53">00110</a> uint8_t <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(uint8_t register_addr, uint8_t *data){
<a name="l00111"></a>00111     uint8_t buff[2];
<a name="l00112"></a>00112     buff[0] = <a class="code" href="nordic_8h.html#afb0b251378d3b14c508e51fd2c3157d6">R_REGISTER</a> | (register_addr &amp; 0x1F);
<a name="l00113"></a>00113     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>, buff, <span class="keyword">sizeof</span>(buff));
<a name="l00114"></a>00114     *data = buff[1];
<a name="l00115"></a>00115     <span class="keywordflow">return</span> buff[0];
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00131"></a><a class="code" href="classnrf.html#adc8177b853777e3fe0eb806ff57971f2">00131</a> uint8_t <a class="code" href="classnrf.html#adc8177b853777e3fe0eb806ff57971f2" title="Lê um bloco de dados do registrador.">nrf::spi_read_multibyte_register</a>(uint8_t register_addr, uint8_t *buff, uint8_t length){
<a name="l00132"></a>00132     uint8_t data[length+1];
<a name="l00133"></a>00133     data[0]=<a class="code" href="nordic_8h.html#afb0b251378d3b14c508e51fd2c3157d6">R_REGISTER</a> | (register_addr &amp; 0x1F);
<a name="l00134"></a>00134     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>, data, <span class="keyword">sizeof</span>(data));
<a name="l00135"></a>00135     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;length;i++)
<a name="l00136"></a>00136         buff[i]=data[i+1];
<a name="l00137"></a>00137     <span class="keywordflow">return</span> data[0];
<a name="l00138"></a>00138 }
<a name="l00139"></a>00139 
<a name="l00149"></a><a class="code" href="classnrf.html#ae6a283eddcb49ab5203fa23d85a39f5c">00149</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#ae6a283eddcb49ab5203fa23d85a39f5c" title="Configura o canal de RF.">nrf::set_rf_channel</a>(uint8_t rf_channel){
<a name="l00150"></a>00150     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a5c4da84e4a01531aa9f5c3e617848d66">RF_CH</a>, rf_channel &amp; 0x7F);
<a name="l00151"></a>00151 }
<a name="l00152"></a>00152     
<a name="l00161"></a><a class="code" href="classnrf.html#a1c99461d7ea34e2369d32b98b6e29e1e">00161</a> uint8_t <a class="code" href="classnrf.html#a1c99461d7ea34e2369d32b98b6e29e1e" title="Retorna o canal de RF.">nrf::get_rf_channel</a>(<span class="keywordtype">void</span>){
<a name="l00162"></a>00162     uint8_t channel;
<a name="l00163"></a>00163     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a5c4da84e4a01531aa9f5c3e617848d66">RF_CH</a>, &amp;channel);
<a name="l00164"></a>00164     <span class="keywordflow">return</span> channel;
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00183"></a><a class="code" href="classnrf.html#aa3d1221c69625052f8c4404c2be6d471">00183</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#aa3d1221c69625052f8c4404c2be6d471" title="Configura a potência do sinal de RF.">nrf::set_rf_power</a>(<a class="code" href="nrf_8h.html#aef7c913300b68ffcbaebc2eea644580a">nrf_power_t</a> power){
<a name="l00184"></a>00184     uint8_t lastValue;
<a name="l00185"></a>00185     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ad95edb7665f39454d7d7fd436301712b">RF_SETUP</a>, &amp;lastValue);
<a name="l00186"></a>00186     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#ad95edb7665f39454d7d7fd436301712b">RF_SETUP</a>, (lastValue &amp; ~<a class="code" href="nordic_8h.html#a1e9fa887f1cf285bc00c17e49569e5f5">RF_PWR</a>) | ( ( (uint8_t) power ) &lt;&lt; 1) );
<a name="l00187"></a>00187 }
<a name="l00188"></a>00188 
<a name="l00202"></a><a class="code" href="classnrf.html#a21b2fe0aa960eee7a7d4d35af23b4498">00202</a> uint8_t <a class="code" href="classnrf.html#a21b2fe0aa960eee7a7d4d35af23b4498" title="Retorna a potência atual do sinal de RF.">nrf::get_rf_power</a>(<span class="keywordtype">void</span>){
<a name="l00203"></a>00203     uint8_t reg;
<a name="l00204"></a>00204     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ad95edb7665f39454d7d7fd436301712b">RF_SETUP</a>,&amp;reg);
<a name="l00205"></a>00205     <span class="keywordflow">return</span> (reg &amp; <a class="code" href="nordic_8h.html#a1e9fa887f1cf285bc00c17e49569e5f5">RF_PWR</a>) &gt;&gt; 1;
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00221"></a><a class="code" href="classnrf.html#a134b5083e12fd69e59ddd7c4ec1f86fb">00221</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a134b5083e12fd69e59ddd7c4ec1f86fb" title="Configura a taxa de dados (bps).">nrf::set_rf_datarate</a>(<a class="code" href="nrf_8h.html#aa8b8c2395f0b103e3558fc9b87e6c290">nrf_datarate_t</a> speed){
<a name="l00222"></a>00222     uint8_t lastValue;
<a name="l00223"></a>00223     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ad95edb7665f39454d7d7fd436301712b">RF_SETUP</a>,&amp;lastValue);
<a name="l00224"></a>00224     <span class="keywordflow">switch</span>(speed){
<a name="l00225"></a>00225         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#aa8b8c2395f0b103e3558fc9b87e6c290adf64314d3a006c1be7fe60845621bc2e">NRF_250KBPS</a>:
<a name="l00226"></a>00226         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#ad95edb7665f39454d7d7fd436301712b">RF_SETUP</a>, (lastValue &amp; ~<a class="code" href="nordic_8h.html#ace5cdf603eecdfb4344114b589442407">RF_DR_HIGH</a>) | <a class="code" href="nordic_8h.html#abd7f2e51313a2bc4be176c747c95f8f9">RF_DR_LOW</a>);
<a name="l00227"></a>00227         <span class="keywordflow">break</span>;
<a name="l00228"></a>00228         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#aa8b8c2395f0b103e3558fc9b87e6c290a31712bdb0199355f6cfe32e5467e43da">NRF_1MBPS</a>:
<a name="l00229"></a>00229         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#ad95edb7665f39454d7d7fd436301712b">RF_SETUP</a>, lastValue &amp; ~(<a class="code" href="nordic_8h.html#ace5cdf603eecdfb4344114b589442407">RF_DR_HIGH</a> | <a class="code" href="nordic_8h.html#abd7f2e51313a2bc4be176c747c95f8f9">RF_DR_LOW</a>));
<a name="l00230"></a>00230         <span class="keywordflow">break</span>;
<a name="l00231"></a>00231         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#aa8b8c2395f0b103e3558fc9b87e6c290a5492e0f45be9142ddfd733cef426bd20">NRF_2MBPS</a>:
<a name="l00232"></a>00232         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#ad95edb7665f39454d7d7fd436301712b">RF_SETUP</a>, (lastValue &amp; ~<a class="code" href="nordic_8h.html#abd7f2e51313a2bc4be176c747c95f8f9">RF_DR_LOW</a>) | <a class="code" href="nordic_8h.html#ace5cdf603eecdfb4344114b589442407">RF_DR_HIGH</a>);
<a name="l00233"></a>00233     }
<a name="l00234"></a>00234 }
<a name="l00235"></a>00235 
<a name="l00249"></a><a class="code" href="classnrf.html#a8477ed309783ba5867c0988af4c80ae0">00249</a> uint8_t <a class="code" href="classnrf.html#a8477ed309783ba5867c0988af4c80ae0" title="Retorna a taxa de dados (bps) atual.">nrf::get_rf_datarate</a>(<span class="keywordtype">void</span>){
<a name="l00250"></a>00250     uint8_t reg;
<a name="l00251"></a>00251     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ad95edb7665f39454d7d7fd436301712b">RF_SETUP</a>, &amp;reg);
<a name="l00252"></a>00252     uint8_t tmp = ((reg &amp; RF_DR_LOW)&gt;&gt;5) | ((reg &amp; RF_DR_HIGH)&gt;&gt;2);
<a name="l00253"></a>00253     <span class="keywordflow">switch</span>(tmp){
<a name="l00254"></a>00254         <span class="keywordflow">case</span> 0:
<a name="l00255"></a>00255         <span class="keywordflow">return</span> 0x01; <span class="comment">//1Mbps</span>
<a name="l00256"></a>00256         <span class="keywordflow">case</span> 1:
<a name="l00257"></a>00257         <span class="keywordflow">return</span> 0x00; <span class="comment">//250kbps</span>
<a name="l00258"></a>00258         <span class="keywordflow">case</span> 2:
<a name="l00259"></a>00259         <span class="keywordflow">return</span> 0x02; <span class="comment">//2Mbps</span>
<a name="l00260"></a>00260         <span class="keywordflow">default</span>:
<a name="l00261"></a>00261         <span class="keywordflow">return</span> 0x03; <span class="comment">//Reserved</span>
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263 }
<a name="l00264"></a>00264 
<a name="l00280"></a><a class="code" href="classnrf.html#aeacf3917c80b37ede2d9d3cc51b6bf1e">00280</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#aeacf3917c80b37ede2d9d3cc51b6bf1e" title="Configura o tamanho do endereço do dispositivo.">nrf::set_address_width</a>(<a class="code" href="nrf_8h.html#aa6e849a2def5e8b06bf877bc448c1a5e">nrf_address_width_t</a> width){
<a name="l00281"></a>00281     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#af5ef355ba3eca336db1285cab353ddc2">SETUP_AW</a>, (uint8_t)width );
<a name="l00282"></a>00282 }
<a name="l00283"></a>00283 
<a name="l00293"></a><a class="code" href="classnrf.html#ad9fd4f4886fcd9adc2b9fb5c843b3969">00293</a> uint8_t <a class="code" href="classnrf.html#ad9fd4f4886fcd9adc2b9fb5c843b3969" title="Retorna o tamanho do endereço atual.">nrf::get_address_width</a>(<span class="keywordtype">void</span>){
<a name="l00294"></a>00294     uint8_t reg;
<a name="l00295"></a>00295     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#af5ef355ba3eca336db1285cab353ddc2">SETUP_AW</a>, &amp;reg);
<a name="l00296"></a>00296     <span class="keywordflow">return</span> reg+2;
<a name="l00297"></a>00297 }
<a name="l00298"></a>00298 
<a name="l00313"></a><a class="code" href="classnrf.html#adef0ba1bf3e125d353e930708b94d51d">00313</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#adef0ba1bf3e125d353e930708b94d51d" title="Habilita pipe.">nrf::enable_rx_pipe</a>(<a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4">nrf_address_t</a> pipe, <span class="keywordtype">bool</span> auto_ack){
<a name="l00314"></a>00314     uint8_t reg;
<a name="l00315"></a>00315     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ab6b2378ce9cab6ccafb6d30c774c5307">EN_RXADDR</a>, &amp;reg);
<a name="l00316"></a>00316     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#ab6b2378ce9cab6ccafb6d30c774c5307">EN_RXADDR</a>, reg | <a class="code" href="nordic_8h.html#a83ee7fd3f13e5f09c1285246a3ea2a38">BIT</a>((uint8_t)pipe));
<a name="l00317"></a>00317     
<a name="l00318"></a>00318     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#aa84a282351a2c9b83dd653df6ac59216">EN_AA</a>, &amp;reg);
<a name="l00319"></a>00319     <span class="keywordflow">if</span>(auto_ack){
<a name="l00320"></a>00320         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#aa84a282351a2c9b83dd653df6ac59216">EN_AA</a>, reg | <a class="code" href="nordic_8h.html#a83ee7fd3f13e5f09c1285246a3ea2a38">BIT</a>((uint8_t)pipe));
<a name="l00321"></a>00321     }<span class="keywordflow">else</span>{
<a name="l00322"></a>00322         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#aa84a282351a2c9b83dd653df6ac59216">EN_AA</a>, reg &amp; ~<a class="code" href="nordic_8h.html#a83ee7fd3f13e5f09c1285246a3ea2a38">BIT</a>((uint8_t)pipe) );
<a name="l00323"></a>00323     }
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 
<a name="l00334"></a><a class="code" href="classnrf.html#a75eeb6beac7627bac9341637ef7c4ef1">00334</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a75eeb6beac7627bac9341637ef7c4ef1" title="Desabilita pipe.">nrf::disable_rx_pipe</a>(<a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4">nrf_address_t</a> pipe){
<a name="l00335"></a>00335     uint8_t reg;
<a name="l00336"></a>00336     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ab6b2378ce9cab6ccafb6d30c774c5307">EN_RXADDR</a>, &amp;reg);
<a name="l00337"></a>00337     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#ab6b2378ce9cab6ccafb6d30c774c5307">EN_RXADDR</a>, reg &amp; ~<a class="code" href="nordic_8h.html#a83ee7fd3f13e5f09c1285246a3ea2a38">BIT</a>((uint8_t)pipe));
<a name="l00338"></a>00338     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#aa84a282351a2c9b83dd653df6ac59216">EN_AA</a>, &amp;reg);
<a name="l00339"></a>00339     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#aa84a282351a2c9b83dd653df6ac59216">EN_AA</a>, reg &amp; ~<a class="code" href="nordic_8h.html#a83ee7fd3f13e5f09c1285246a3ea2a38">BIT</a>((uint8_t)pipe) );
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00356"></a><a class="code" href="classnrf.html#aceb25880996640f22d4e71ac254e0eae">00356</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#aceb25880996640f22d4e71ac254e0eae" title="Configura endereços de recepção.">nrf::set_rx_address</a>(<a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4">nrf_address_t</a> pipe, uint8_t *addr, uint8_t length){
<a name="l00357"></a>00357     <span class="keywordflow">switch</span>(pipe){
<a name="l00358"></a>00358         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4abaeb8791fe0342cade8db09107b1aed0">NRF_PIPE0</a>:
<a name="l00359"></a>00359         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4a1fae01fbfff1b88562ba4aae2ac8c9cf">NRF_PIPE1</a>:
<a name="l00360"></a>00360         <a class="code" href="classnrf.html#abbed07bbeb60fb2090f2ffba58fab16b" title="Escreve um bloco de dados no registrador.">nrf::spi_write_multibyte_register</a>( <a class="code" href="nordic_8h.html#adc82a1b0dee303d8b783b9b9a89ae5aa">RX_ADDR_P0</a> + (uint8_t) pipe, addr, length);
<a name="l00361"></a>00361         <span class="keywordflow">break</span>;
<a name="l00362"></a>00362         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4af7db4e291ec2c6c15060cc5426b92eba">NRF_PIPE2</a>:
<a name="l00363"></a>00363         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4a919be87ccfa5209894438c2cc1b9bcd9">NRF_PIPE3</a>:
<a name="l00364"></a>00364         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4ab7495b387ec5cb15aaab4a331a0c69c4">NRF_PIPE4</a>:
<a name="l00365"></a>00365         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4a99787dedcb3526eb415f244952205339">NRF_PIPE5</a>:
<a name="l00366"></a>00366             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#adc82a1b0dee303d8b783b9b9a89ae5aa">RX_ADDR_P0</a> + (uint8_t) pipe, *addr);
<a name="l00367"></a>00367     }
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00380"></a><a class="code" href="classnrf.html#a95d9ebd55679064effbdd2d83305ac98">00380</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a95d9ebd55679064effbdd2d83305ac98" title="Configura o tamanho do payload para recepção.">nrf::set_static_payload_width</a>(<a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4">nrf_address_t</a> pipe, uint8_t width){
<a name="l00381"></a>00381     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a060e61d8f6e7ad28984540faa85cdecf">RX_PW_P0</a> + (uint8_t) pipe, width &amp; 0x3F);
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00394"></a><a class="code" href="classnrf.html#a27ec9c936d039ea105d37d02ecd3f38e">00394</a> uint8_t <a class="code" href="classnrf.html#a27ec9c936d039ea105d37d02ecd3f38e" title="Retorna o tamanho do payload.">nrf::get_static_payload_width</a>(<a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4">nrf_address_t</a> pipe){
<a name="l00395"></a>00395     uint8_t reg;
<a name="l00396"></a>00396     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a060e61d8f6e7ad28984540faa85cdecf">RX_PW_P0</a> + (uint8_t) pipe, &amp;reg);
<a name="l00397"></a>00397     <span class="keywordflow">return</span> reg;
<a name="l00398"></a>00398 }
<a name="l00399"></a>00399 
<a name="l00411"></a><a class="code" href="classnrf.html#af038fc525d5702ff533cd5bd014ab5ee">00411</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#af038fc525d5702ff533cd5bd014ab5ee" title="Configura o endereço de transmissão.">nrf::set_tx_address</a>(uint8_t *addr, uint8_t length){
<a name="l00412"></a>00412     <a class="code" href="classnrf.html#abbed07bbeb60fb2090f2ffba58fab16b" title="Escreve um bloco de dados no registrador.">nrf::spi_write_multibyte_register</a>(<a class="code" href="nordic_8h.html#aa734c6e08b9f794436eacbabe466a6c4">TX_ADDR</a>, addr, length);
<a name="l00413"></a>00413 }
<a name="l00414"></a>00414 
<a name="l00427"></a><a class="code" href="classnrf.html#a134acc1d52019ede259b915869c0bf5b">00427</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a134acc1d52019ede259b915869c0bf5b" title="Configura os parâmetros de retransmissão.">nrf::set_retr_param</a>(uint8_t retr_count, uint8_t retr_delay){
<a name="l00428"></a>00428     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a2188309b3eceeae158dd64109cd919aa">SETUP_RETR</a>, ((retr_delay &amp; 0x0F)&lt;&lt;4) | (retr_count &amp; 0x0F) );
<a name="l00429"></a>00429 }
<a name="l00430"></a>00430 
<a name="l00438"></a><a class="code" href="classnrf.html#a6514e7743c8d8845132a16aa2de164a1">00438</a> uint8_t <a class="code" href="classnrf.html#a6514e7743c8d8845132a16aa2de164a1" title="Retorna os parâmetros de retransmissão.">nrf::get_retr_param</a>(<span class="keywordtype">void</span>){
<a name="l00439"></a>00439     uint8_t reg;
<a name="l00440"></a>00440     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a2188309b3eceeae158dd64109cd919aa">SETUP_RETR</a>, &amp;reg);
<a name="l00441"></a>00441     <span class="keywordflow">return</span> reg;
<a name="l00442"></a>00442 }
<a name="l00443"></a>00443 
<a name="l00454"></a><a class="code" href="classnrf.html#a36b6dcf9a7457520622369ec7d0efc26">00454</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a36b6dcf9a7457520622369ec7d0efc26" title="Seleciona o argoritmo de cálculo do CRC.">nrf::set_crc_mode</a>(<a class="code" href="nrf_8h.html#a981bcae96000b642237ccc1d8b8c2ed2">nrf_crc_mode_t</a> crc_mode){
<a name="l00455"></a>00455     uint8_t lastValue;
<a name="l00456"></a>00456     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, &amp;lastValue);
<a name="l00457"></a>00457     <span class="keywordflow">switch</span>(crc_mode){
<a name="l00458"></a>00458         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#a981bcae96000b642237ccc1d8b8c2ed2a78c60fab5bf7a6db66a73b479188aa78">NRF_CRC_1BYTE</a>:
<a name="l00459"></a>00459         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, (lastValue &amp; ~<a class="code" href="nordic_8h.html#a253dd73b17f0ea7f71e55f52e796836a">CRCO</a>) | <a class="code" href="nordic_8h.html#aece57618cf42f6b1b520341ef19a66f8">EN_CRC</a>);
<a name="l00460"></a>00460         <span class="keywordflow">break</span>;
<a name="l00461"></a>00461         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#a981bcae96000b642237ccc1d8b8c2ed2a7e2d319c6823ee1064d257c2129e5f31">NRF_CRC_2BYTES</a>:
<a name="l00462"></a>00462         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, lastValue | <a class="code" href="nordic_8h.html#a253dd73b17f0ea7f71e55f52e796836a">CRCO</a> | <a class="code" href="nordic_8h.html#aece57618cf42f6b1b520341ef19a66f8">EN_CRC</a>);
<a name="l00463"></a>00463     }
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00473"></a><a class="code" href="classnrf.html#a88b00a3dbae977c6edaf3943bb8d8728">00473</a> uint8_t <a class="code" href="classnrf.html#a88b00a3dbae977c6edaf3943bb8d8728" title="Retorna o argoritmo de cálculo do CRC.">nrf::get_crc_mode</a>(<span class="keywordtype">void</span>){
<a name="l00474"></a>00474     uint8_t reg;
<a name="l00475"></a>00475     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, &amp;reg);
<a name="l00476"></a>00476     <span class="keywordflow">if</span>(reg &amp; <a class="code" href="nordic_8h.html#aece57618cf42f6b1b520341ef19a66f8">EN_CRC</a>){
<a name="l00477"></a>00477         <span class="keywordflow">if</span>(reg &amp; <a class="code" href="nordic_8h.html#a253dd73b17f0ea7f71e55f52e796836a">CRCO</a>){
<a name="l00478"></a>00478             <span class="keywordflow">return</span> 0x02;
<a name="l00479"></a>00479         }<span class="keywordflow">else</span>{
<a name="l00480"></a>00480             <span class="keywordflow">return</span> 0x01;
<a name="l00481"></a>00481         }
<a name="l00482"></a>00482     }<span class="keywordflow">else</span>{
<a name="l00483"></a>00483         <span class="keywordflow">return</span> 0x00;
<a name="l00484"></a>00484     }
<a name="l00485"></a>00485 }
<a name="l00486"></a>00486 
<a name="l00491"></a><a class="code" href="classnrf.html#a674251450acee6d20090741155f793fa">00491</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a674251450acee6d20090741155f793fa" title="Descarrega buffer de recepção.">nrf::flush_rx_fifo</a>(<span class="keywordtype">void</span>){
<a name="l00492"></a>00492     uint8_t data = FLUSH_RX;
<a name="l00493"></a>00493     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>, &amp;data, <span class="keyword">sizeof</span>(data));
<a name="l00494"></a>00494 }
<a name="l00495"></a>00495 
<a name="l00500"></a><a class="code" href="classnrf.html#a89449d9aadc1957b3f6631780822f8be">00500</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a89449d9aadc1957b3f6631780822f8be" title="Descarrega buffer de transmissão.">nrf::flush_tx_fifo</a>(<span class="keywordtype">void</span>){
<a name="l00501"></a>00501     uint8_t data = FLUSH_TX;
<a name="l00502"></a>00502     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>, &amp;data, <span class="keyword">sizeof</span>(data));
<a name="l00503"></a>00503 }
<a name="l00504"></a>00504 
<a name="l00511"></a><a class="code" href="classnrf.html#a6d5e06d2effe8579ac57e5ad648d63e7">00511</a> uint8_t <a class="code" href="classnrf.html#a6d5e06d2effe8579ac57e5ad648d63e7" title="Retorna o estado do dispositivo.">nrf::get_status</a>(<span class="keywordtype">void</span>){
<a name="l00512"></a>00512     uint8_t reg=NOP;
<a name="l00513"></a>00513     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>, &amp;reg, <span class="keyword">sizeof</span>(reg));
<a name="l00514"></a>00514     <span class="keywordflow">return</span> reg;
<a name="l00515"></a>00515 }
<a name="l00516"></a>00516 
<a name="l00523"></a><a class="code" href="classnrf.html#a08d4decf99a5cc9f04697ec0b8cad1c3">00523</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a08d4decf99a5cc9f04697ec0b8cad1c3" title="Limpa todos os flags de interrupção.">nrf::clear_all_int_flags</a>(<span class="keywordtype">void</span>){
<a name="l00524"></a>00524     uint8_t lastValue=<a class="code" href="classnrf.html#a6d5e06d2effe8579ac57e5ad648d63e7" title="Retorna o estado do dispositivo.">nrf::get_status</a>();
<a name="l00525"></a>00525     <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a59279bee44f34d08b3cbf3a89fb0d8d9">STATUS</a>, lastValue | (<a class="code" href="nordic_8h.html#a312d1f2745a86149b27cff7d61e715df">RX_DR</a>|<a class="code" href="nordic_8h.html#ab5f5243908a39ffd514fe701e9749bdc">TX_DS</a>|<a class="code" href="nordic_8h.html#ab4482ead4f3b452a032f63ac03ee1870">MAX_RT</a>) );
<a name="l00526"></a>00526 }
<a name="l00527"></a>00527 
<a name="l00540"></a><a class="code" href="classnrf.html#ad157c8856912fd56b6103fa8f940038b">00540</a> <span class="keywordtype">bool</span> <a class="code" href="classnrf.html#ad157c8856912fd56b6103fa8f940038b" title="Verifica se pacote foi recebido.">nrf::available</a>(<span class="keywordtype">void</span>){
<a name="l00541"></a>00541     uint8_t fifo_status = <a class="code" href="classnrf.html#a0904f4978e6cbeb63c8a393f1ee9299f" title="Retorna o estado dos buffers de recepção e transmissão.">nrf::get_fifo_status</a>();
<a name="l00542"></a>00542     <span class="keywordflow">if</span>(!(fifo_status &amp; <a class="code" href="nordic_8h.html#a8e43dfdec50b513f49b623e9da3def46">RX_EMPTY</a>)){
<a name="l00543"></a>00543         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00544"></a>00544     }<span class="keywordflow">else</span>{
<a name="l00545"></a>00545         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547 }
<a name="l00548"></a>00548 
<a name="l00563"></a><a class="code" href="classnrf.html#a05dbe730d7821617e94b7f94985bdf46">00563</a> uint8_t <a class="code" href="classnrf.html#a05dbe730d7821617e94b7f94985bdf46" title="Retorna o valor do pipe em que houve recepção do último pacote.">nrf::get_data_source</a>(<span class="keywordtype">void</span>){                           
<a name="l00564"></a>00564     uint8_t reg = <a class="code" href="classnrf.html#a6d5e06d2effe8579ac57e5ad648d63e7" title="Retorna o estado do dispositivo.">nrf::get_status</a>();
<a name="l00565"></a>00565     <span class="keywordflow">return</span> (reg &amp; <a class="code" href="nordic_8h.html#aaafdcd7fe52991daff2385165e8547ab">RX_P_NO</a>) &gt;&gt; 1;
<a name="l00566"></a>00566 }
<a name="l00567"></a>00567 
<a name="l00579"></a><a class="code" href="classnrf.html#a103c4967d87d8c7834d29f48ecc6853e">00579</a> <span class="keywordtype">bool</span> <a class="code" href="classnrf.html#a103c4967d87d8c7834d29f48ecc6853e" title="Lê o payload do pacote recebido.">nrf::read_received_payload</a>(uint8_t *buff, uint8_t *length){
<a name="l00580"></a>00580     <span class="keywordflow">if</span>( !(<a class="code" href="classnrf.html#ad157c8856912fd56b6103fa8f940038b" title="Verifica se pacote foi recebido.">nrf::available</a>()) ){
<a name="l00581"></a>00581         buff=NULL;
<a name="l00582"></a>00582         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00583"></a>00583     }
<a name="l00584"></a>00584     
<a name="l00585"></a>00585     *length = <a class="code" href="classnrf.html#a8314f44f01b6be582544289d90dce593" title="Retorna o tamanho do payload recebido.">nrf::get_received_payload_width</a>();
<a name="l00586"></a>00586     <span class="keywordflow">if</span>(*length&gt;32){
<a name="l00587"></a>00587         <a class="code" href="classnrf.html#a674251450acee6d20090741155f793fa" title="Descarrega buffer de recepção.">nrf::flush_rx_fifo</a>();
<a name="l00588"></a>00588         <a class="code" href="classnrf.html#a63682fdd6cc605b1cdc576002620c4cb" title="Limpa flag de interrupção.">nrf::clear_int_flag</a>(<a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891a384b31f70629e7a887970b8750e603e8">NRF_RX_DR</a>);
<a name="l00589"></a>00589         buff=NULL;
<a name="l00590"></a>00590         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592     
<a name="l00593"></a>00593     uint8_t incoming[*length+1];
<a name="l00594"></a>00594     incoming[0]= R_RX_PAYLOAD;
<a name="l00595"></a>00595     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>,incoming,<span class="keyword">sizeof</span>(incoming));
<a name="l00596"></a>00596     
<a name="l00597"></a>00597     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;*length;i++)
<a name="l00598"></a>00598         buff[i]=incoming[i+1];
<a name="l00599"></a>00599     
<a name="l00600"></a>00600     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00601"></a>00601 }
<a name="l00602"></a>00602 
<a name="l00609"></a><a class="code" href="classnrf.html#a755654e2dc2c5d095e35665404efeba9">00609</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a755654e2dc2c5d095e35665404efeba9" title="Bloqueia a execução do programa até a chegada de um pacote.">nrf::wait_available</a>(<span class="keywordtype">void</span>){
<a name="l00610"></a>00610     <span class="keywordflow">while</span>( !(<a class="code" href="classnrf.html#ad157c8856912fd56b6103fa8f940038b" title="Verifica se pacote foi recebido.">nrf::available</a>()) ){
<a name="l00611"></a>00611     }
<a name="l00612"></a>00612 }
<a name="l00613"></a>00613 
<a name="l00624"></a><a class="code" href="classnrf.html#a75f743297a4f7fc770bad6b130a17f96">00624</a> <span class="keywordtype">bool</span> <a class="code" href="classnrf.html#a75f743297a4f7fc770bad6b130a17f96" title="Bloqueia a executação do programa até a chegada de um pacote ou timeout ocorrer.">nrf::wait_available_timeout</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timeout){
<a name="l00625"></a>00625     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> currentTime = millis();
<a name="l00626"></a>00626     <span class="keywordflow">while</span>( (millis() - currentTime) &lt; timeout ){
<a name="l00627"></a>00627         <span class="keywordflow">if</span>(<a class="code" href="classnrf.html#ad157c8856912fd56b6103fa8f940038b" title="Verifica se pacote foi recebido.">nrf::available</a>()){
<a name="l00628"></a>00628             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00629"></a>00629         }
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00632"></a>00632 }
<a name="l00633"></a>00633 
<a name="l00641"></a><a class="code" href="classnrf.html#a6568bbc3dab2410df222e1247b4b87d5">00641</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a6568bbc3dab2410df222e1247b4b87d5" title="Configura o modo de potência do dispositivo.">nrf::set_power_up</a>(<span class="keywordtype">bool</span> pwr_up){
<a name="l00642"></a>00642     uint8_t lastValue;
<a name="l00643"></a>00643     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>,&amp;lastValue);
<a name="l00644"></a>00644     <span class="keywordflow">if</span>(pwr_up){
<a name="l00645"></a>00645         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, lastValue | <a class="code" href="nordic_8h.html#af0dbd9e4c17ba0db357fcb2cedd4aa6d">PWR_UP</a>);
<a name="l00646"></a>00646     }<span class="keywordflow">else</span>{
<a name="l00647"></a>00647         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, lastValue &amp; ~<a class="code" href="nordic_8h.html#af0dbd9e4c17ba0db357fcb2cedd4aa6d">PWR_UP</a>);  
<a name="l00648"></a>00648     }
<a name="l00649"></a>00649 }
<a name="l00650"></a>00650 
<a name="l00658"></a><a class="code" href="classnrf.html#a833792eb23819e3b9c7765ad41e38578">00658</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a833792eb23819e3b9c7765ad41e38578" title="Configura o modo primário do dispositivo.">nrf::set_primary_rx</a>(<span class="keywordtype">bool</span> prim_rx){
<a name="l00659"></a>00659     uint8_t lastValue;
<a name="l00660"></a>00660     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, &amp;lastValue);
<a name="l00661"></a>00661     <span class="keywordflow">if</span>(prim_rx){
<a name="l00662"></a>00662         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, lastValue | <a class="code" href="nordic_8h.html#a0b4d92f3ecccb150d4cb1cb5d0f9d4e6">PRIM_RX</a>);
<a name="l00663"></a>00663     }<span class="keywordflow">else</span>{
<a name="l00664"></a>00664         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, lastValue &amp; ~<a class="code" href="nordic_8h.html#a0b4d92f3ecccb150d4cb1cb5d0f9d4e6">PRIM_RX</a>);
<a name="l00665"></a>00665     }
<a name="l00666"></a>00666 }
<a name="l00667"></a>00667 
<a name="l00673"></a><a class="code" href="classnrf.html#a63682fdd6cc605b1cdc576002620c4cb">00673</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a63682fdd6cc605b1cdc576002620c4cb" title="Limpa flag de interrupção.">nrf::clear_int_flag</a>(<a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891">nrf_int_source_t</a> int_source){
<a name="l00674"></a>00674     uint8_t lastValue = <a class="code" href="classnrf.html#a6d5e06d2effe8579ac57e5ad648d63e7" title="Retorna o estado do dispositivo.">nrf::get_status</a>();
<a name="l00675"></a>00675     <span class="keywordflow">switch</span>(int_source){
<a name="l00676"></a>00676         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891a384b31f70629e7a887970b8750e603e8">NRF_RX_DR</a>:
<a name="l00677"></a>00677             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a59279bee44f34d08b3cbf3a89fb0d8d9">STATUS</a>, lastValue | <a class="code" href="nordic_8h.html#a312d1f2745a86149b27cff7d61e715df">RX_DR</a>);
<a name="l00678"></a>00678             <span class="keywordflow">break</span>;
<a name="l00679"></a>00679         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891ade79c0fb1841ecbb129802239980b4c2">NRF_TX_DS</a>:
<a name="l00680"></a>00680             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a59279bee44f34d08b3cbf3a89fb0d8d9">STATUS</a>, lastValue | <a class="code" href="nordic_8h.html#ab5f5243908a39ffd514fe701e9749bdc">TX_DS</a>);
<a name="l00681"></a>00681             <span class="keywordflow">break</span>;
<a name="l00682"></a>00682         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891a993bd99eb0950eadd9efab50a6ad3826">NRF_MAX_RT</a>:
<a name="l00683"></a>00683             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a59279bee44f34d08b3cbf3a89fb0d8d9">STATUS</a>, lastValue | <a class="code" href="nordic_8h.html#ab4482ead4f3b452a032f63ac03ee1870">MAX_RT</a>);
<a name="l00684"></a>00684     }    
<a name="l00685"></a>00685 }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 
<a name="l00694"></a><a class="code" href="classnrf.html#a1a8415dfd997f23fafdff9372556ea74">00694</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a1a8415dfd997f23fafdff9372556ea74" title="Imprime no terminal serial o conteúdo dos registradores de configuração.">nrf::print_registers</a>(<span class="keywordtype">void</span>){
<a name="l00695"></a>00695   uint8_t reg,address_width;
<a name="l00696"></a>00696   Serial.print(<span class="stringliteral">&quot;--- Register&#39;s content (in hexa) ---\n&quot;</span>);
<a name="l00697"></a>00697 
<a name="l00698"></a>00698   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>,&amp;reg);
<a name="l00699"></a>00699   Serial.print(<span class="stringliteral">&quot;CONFIG: &quot;</span>);
<a name="l00700"></a>00700   Serial.println(reg,HEX);
<a name="l00701"></a>00701 
<a name="l00702"></a>00702   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#aa84a282351a2c9b83dd653df6ac59216">EN_AA</a>,&amp;reg);  
<a name="l00703"></a>00703   Serial.print(<span class="stringliteral">&quot;EN_AA: &quot;</span>);
<a name="l00704"></a>00704   Serial.println(reg,HEX);
<a name="l00705"></a>00705 
<a name="l00706"></a>00706   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ab6b2378ce9cab6ccafb6d30c774c5307">EN_RXADDR</a>,&amp;reg);  
<a name="l00707"></a>00707   Serial.print(<span class="stringliteral">&quot;EN_RXADDR: &quot;</span>);
<a name="l00708"></a>00708   Serial.println(reg,HEX);
<a name="l00709"></a>00709   
<a name="l00710"></a>00710   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#af5ef355ba3eca336db1285cab353ddc2">SETUP_AW</a>,&amp;reg); 
<a name="l00711"></a>00711   address_width=reg+2;
<a name="l00712"></a>00712   Serial.print(<span class="stringliteral">&quot;SETUP_AW: &quot;</span>);
<a name="l00713"></a>00713   Serial.println(reg,HEX);
<a name="l00714"></a>00714   
<a name="l00715"></a>00715   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a2188309b3eceeae158dd64109cd919aa">SETUP_RETR</a>,&amp;reg);  
<a name="l00716"></a>00716   Serial.print(<span class="stringliteral">&quot;SETUP_RETR: &quot;</span>);
<a name="l00717"></a>00717   Serial.println(reg,HEX);  
<a name="l00718"></a>00718   
<a name="l00719"></a>00719   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a5c4da84e4a01531aa9f5c3e617848d66">RF_CH</a>,&amp;reg);  
<a name="l00720"></a>00720   Serial.print(<span class="stringliteral">&quot;RF_CH: &quot;</span>);
<a name="l00721"></a>00721   Serial.println(reg,HEX); 
<a name="l00722"></a>00722   
<a name="l00723"></a>00723   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ad95edb7665f39454d7d7fd436301712b">RF_SETUP</a>,&amp;reg);  
<a name="l00724"></a>00724   Serial.print(<span class="stringliteral">&quot;RF_SETUP: &quot;</span>);
<a name="l00725"></a>00725   Serial.println(reg,HEX);
<a name="l00726"></a>00726   
<a name="l00727"></a>00727   Serial.print(<span class="stringliteral">&quot;STATUS: &quot;</span>);
<a name="l00728"></a>00728   Serial.println(<a class="code" href="classnrf.html#a6d5e06d2effe8579ac57e5ad648d63e7" title="Retorna o estado do dispositivo.">nrf::get_status</a>(),HEX);
<a name="l00729"></a>00729 
<a name="l00730"></a>00730   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a491468eaa7f2db84c152709b0b5fb1aa">OBSERVE_TX</a>,&amp;reg);  
<a name="l00731"></a>00731   Serial.print(<span class="stringliteral">&quot;OBSERVE_TX: &quot;</span>);
<a name="l00732"></a>00732   Serial.println(reg,HEX);
<a name="l00733"></a>00733   
<a name="l00734"></a>00734   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ab9743a9a0928c8f19ad9687ae6c67150">RPD</a>,&amp;reg);  
<a name="l00735"></a>00735   Serial.print(<span class="stringliteral">&quot;RPD: &quot;</span>);
<a name="l00736"></a>00736   Serial.println(reg,HEX);
<a name="l00737"></a>00737   
<a name="l00738"></a>00738   uint8_t buff[5];
<a name="l00739"></a>00739   <a class="code" href="classnrf.html#adc8177b853777e3fe0eb806ff57971f2" title="Lê um bloco de dados do registrador.">nrf::spi_read_multibyte_register</a>(<a class="code" href="nordic_8h.html#adc82a1b0dee303d8b783b9b9a89ae5aa">RX_ADDR_P0</a>, buff, address_width);
<a name="l00740"></a>00740   Serial.print(<span class="stringliteral">&quot;RX_ADDR_P0 (LSB first): &quot;</span>);
<a name="l00741"></a>00741   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;address_width;i++){
<a name="l00742"></a>00742     Serial.print(buff[i],HEX);
<a name="l00743"></a>00743     Serial.print(<span class="stringliteral">&quot; &quot;</span>);
<a name="l00744"></a>00744   }
<a name="l00745"></a>00745   Serial.print(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00746"></a>00746   
<a name="l00747"></a>00747   
<a name="l00748"></a>00748   <a class="code" href="classnrf.html#adc8177b853777e3fe0eb806ff57971f2" title="Lê um bloco de dados do registrador.">nrf::spi_read_multibyte_register</a>(<a class="code" href="nordic_8h.html#ad4b44f18e4b27b07af84783d8f11726d">RX_ADDR_P1</a>, buff, address_width);
<a name="l00749"></a>00749   Serial.print(<span class="stringliteral">&quot;RX_ADDR_P1 (LSB first): &quot;</span>);
<a name="l00750"></a>00750   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;address_width;i++){
<a name="l00751"></a>00751     Serial.print(buff[i],HEX);
<a name="l00752"></a>00752     Serial.print(<span class="stringliteral">&quot; &quot;</span>);
<a name="l00753"></a>00753   }
<a name="l00754"></a>00754   Serial.print(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00755"></a>00755   
<a name="l00756"></a>00756   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ac10ad4b1d3ace06cc269098d1863f411">RX_ADDR_P2</a>,&amp;reg);  
<a name="l00757"></a>00757   Serial.print(<span class="stringliteral">&quot;RX_ADDR_P2: &quot;</span>);
<a name="l00758"></a>00758   Serial.println(reg,HEX);
<a name="l00759"></a>00759   
<a name="l00760"></a>00760   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a01228e7b997954bc9d715c8289731181">RX_ADDR_P3</a>,&amp;reg);  
<a name="l00761"></a>00761   Serial.print(<span class="stringliteral">&quot;RX_ADDR_P3: &quot;</span>);
<a name="l00762"></a>00762   Serial.println(reg,HEX);
<a name="l00763"></a>00763 
<a name="l00764"></a>00764   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#afc579afe21136cd3f72b3ac805086726">RX_ADDR_P4</a>,&amp;reg);  
<a name="l00765"></a>00765   Serial.print(<span class="stringliteral">&quot;RX_ADDR_P4: &quot;</span>);
<a name="l00766"></a>00766   Serial.println(reg,HEX);
<a name="l00767"></a>00767   
<a name="l00768"></a>00768   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a49dfc07335896551e8c7797594658b07">RX_ADDR_P5</a>,&amp;reg);  
<a name="l00769"></a>00769   Serial.print(<span class="stringliteral">&quot;RX_ADDR_P5: &quot;</span>);
<a name="l00770"></a>00770   Serial.println(reg,HEX);
<a name="l00771"></a>00771   
<a name="l00772"></a>00772   <a class="code" href="classnrf.html#adc8177b853777e3fe0eb806ff57971f2" title="Lê um bloco de dados do registrador.">nrf::spi_read_multibyte_register</a>(<a class="code" href="nordic_8h.html#aa734c6e08b9f794436eacbabe466a6c4">TX_ADDR</a>, buff, address_width);
<a name="l00773"></a>00773   Serial.print(<span class="stringliteral">&quot;TX_ADDR (LSB first): &quot;</span>);
<a name="l00774"></a>00774   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;address_width;i++){
<a name="l00775"></a>00775     Serial.print(buff[i],HEX);
<a name="l00776"></a>00776     Serial.print(<span class="stringliteral">&quot; &quot;</span>);
<a name="l00777"></a>00777   }
<a name="l00778"></a>00778   Serial.print(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00779"></a>00779 
<a name="l00780"></a>00780   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a060e61d8f6e7ad28984540faa85cdecf">RX_PW_P0</a>,&amp;reg);  
<a name="l00781"></a>00781   Serial.print(<span class="stringliteral">&quot;RX_PW_P0: &quot;</span>);
<a name="l00782"></a>00782   Serial.println(reg,HEX);
<a name="l00783"></a>00783   
<a name="l00784"></a>00784   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#aa260ec97512905cec17f8ade82bc550d">RX_PW_P1</a>,&amp;reg);  
<a name="l00785"></a>00785   Serial.print(<span class="stringliteral">&quot;RX_PW_P1: &quot;</span>);
<a name="l00786"></a>00786   Serial.println(reg,HEX);
<a name="l00787"></a>00787   
<a name="l00788"></a>00788   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a38a4904a52517c8d339c689230a6567d">RX_PW_P2</a>,&amp;reg);  
<a name="l00789"></a>00789   Serial.print(<span class="stringliteral">&quot;RX_PW_P2: &quot;</span>);
<a name="l00790"></a>00790   Serial.println(reg,HEX);
<a name="l00791"></a>00791   
<a name="l00792"></a>00792   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a44bdf6946c1ae047ea2a2c981244d4d8">RX_PW_P3</a>,&amp;reg);  
<a name="l00793"></a>00793   Serial.print(<span class="stringliteral">&quot;RX_PW_P3: &quot;</span>);
<a name="l00794"></a>00794   Serial.println(reg,HEX);
<a name="l00795"></a>00795   
<a name="l00796"></a>00796   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a5cdda00ab52df1537b6b5d61ef88ba8f">RX_PW_P4</a>,&amp;reg);  
<a name="l00797"></a>00797   Serial.print(<span class="stringliteral">&quot;RX_PW_P4: &quot;</span>);
<a name="l00798"></a>00798   Serial.println(reg,HEX);
<a name="l00799"></a>00799   
<a name="l00800"></a>00800   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a9ce52902779e18d4fed3685b0f8be582">RX_PW_P5</a>,&amp;reg);  
<a name="l00801"></a>00801   Serial.print(<span class="stringliteral">&quot;RX_PW_P5: &quot;</span>);
<a name="l00802"></a>00802   Serial.println(reg,HEX);
<a name="l00803"></a>00803   
<a name="l00804"></a>00804   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a9e5c9878194f462bf7a46ca8a7b8f9d2">FIFO_STATUS</a>,&amp;reg);  
<a name="l00805"></a>00805   Serial.print(<span class="stringliteral">&quot;FIFO_STATUS: &quot;</span>);
<a name="l00806"></a>00806   Serial.println(reg,HEX);
<a name="l00807"></a>00807   
<a name="l00808"></a>00808   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ae79cde384e0b6a5549efb001589a79ec">DYNPD</a>,&amp;reg);  
<a name="l00809"></a>00809   Serial.print(<span class="stringliteral">&quot;DYNPD: &quot;</span>);
<a name="l00810"></a>00810   Serial.println(reg,HEX);
<a name="l00811"></a>00811   
<a name="l00812"></a>00812   <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#adf81f7b30b6c08465ce704956b446a2d">FEATURE</a>,&amp;reg);  
<a name="l00813"></a>00813   Serial.print(<span class="stringliteral">&quot;FEATURE: &quot;</span>);
<a name="l00814"></a>00814   Serial.println(reg,HEX);
<a name="l00815"></a>00815   
<a name="l00816"></a>00816 }
<a name="l00817"></a>00817 
<a name="l00825"></a><a class="code" href="classnrf.html#abfc4ce788178088e7a9596b730b34862">00825</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#abfc4ce788178088e7a9596b730b34862" title="Imprime no terminal serial o conteúdo de um registrador ou buffer de dados.">nrf::print_buffer</a>(uint8_t *buff, uint8_t length){
<a name="l00826"></a>00826     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;length;i++){
<a name="l00827"></a>00827         Serial.print(buff[i],HEX);
<a name="l00828"></a>00828         Serial.print(<span class="stringliteral">&quot; &quot;</span>);
<a name="l00829"></a>00829     }
<a name="l00830"></a>00830 }
<a name="l00831"></a>00831 
<a name="l00838"></a><a class="code" href="classnrf.html#a0904f4978e6cbeb63c8a393f1ee9299f">00838</a> uint8_t <a class="code" href="classnrf.html#a0904f4978e6cbeb63c8a393f1ee9299f" title="Retorna o estado dos buffers de recepção e transmissão.">nrf::get_fifo_status</a>(<span class="keywordtype">void</span>){
<a name="l00839"></a>00839     uint8_t reg;
<a name="l00840"></a>00840     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a9e5c9878194f462bf7a46ca8a7b8f9d2">FIFO_STATUS</a>,&amp;reg);
<a name="l00841"></a>00841     <span class="keywordflow">return</span> reg;
<a name="l00842"></a>00842 }
<a name="l00843"></a>00843 
<a name="l00856"></a><a class="code" href="classnrf.html#aab204842fe0a95b7962debcf8fbb7eb7">00856</a> <span class="keywordtype">bool</span> <a class="code" href="classnrf.html#aab204842fe0a95b7962debcf8fbb7eb7" title="Escreve o payload no buffer de transmissão.">nrf::write_tx_payload</a>(uint8_t *buff, uint8_t length, <span class="keywordtype">bool</span> auto_ack){
<a name="l00857"></a>00857     
<a name="l00858"></a>00858     <span class="keywordflow">if</span>(<a class="code" href="classnrf.html#a0904f4978e6cbeb63c8a393f1ee9299f" title="Retorna o estado dos buffers de recepção e transmissão.">nrf::get_fifo_status</a>() &amp; <a class="code" href="nordic_8h.html#a22d7127287df037834795bbf984d7796">TX_FIFO_FULL</a>){
<a name="l00859"></a>00859         <span class="keywordflow">return</span> <span class="keyword">false</span>; 
<a name="l00860"></a>00860     }
<a name="l00861"></a>00861     
<a name="l00862"></a>00862     uint8_t outcoming[length+1];
<a name="l00863"></a>00863     outcoming[0]=(auto_ack)? <a class="code" href="nordic_8h.html#afd12673bc8ca8559b0eee395e8845982">W_TX_PAYLOAD</a>:<a class="code" href="nordic_8h.html#a974e6df1de481bc7796a2c1c96b6c9ff">W_TX_PAYLOAD_NOACK</a>;
<a name="l00864"></a>00864     
<a name="l00865"></a>00865     <span class="comment">//copy data</span>
<a name="l00866"></a>00866     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;length;i++)
<a name="l00867"></a>00867         outcoming[i+1]=buff[i];
<a name="l00868"></a>00868     
<a name="l00869"></a>00869     <span class="comment">// write into tx fifo</span>
<a name="l00870"></a>00870     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>, outcoming, <span class="keyword">sizeof</span>(outcoming));
<a name="l00871"></a>00871     
<a name="l00872"></a>00872     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00873"></a>00873 }
<a name="l00874"></a>00874 
<a name="l00885"></a><a class="code" href="classnrf.html#a08862718e5c1c3f9e9c142230af3c661">00885</a> <span class="keywordtype">bool</span> <a class="code" href="classnrf.html#a08862718e5c1c3f9e9c142230af3c661" title="Aguarda o envio do pacote.">nrf::wait_packet_sent</a>(<span class="keywordtype">void</span>){
<a name="l00886"></a>00886     uint8_t config;
<a name="l00887"></a>00887     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, &amp;config);
<a name="l00888"></a>00888     <span class="keywordflow">if</span>( (config &amp; <a class="code" href="nordic_8h.html#a0b4d92f3ecccb150d4cb1cb5d0f9d4e6">PRIM_RX</a>) | !digitalRead(<a class="code" href="classnrf.html#a65df277c87190fb9ec66f4855edf61d5">_ce</a>) | !(config &amp; <a class="code" href="nordic_8h.html#af0dbd9e4c17ba0db357fcb2cedd4aa6d">PWR_UP</a>) )  
<a name="l00889"></a>00889         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00890"></a>00890     
<a name="l00891"></a>00891     <span class="keywordflow">do</span>{
<a name="l00892"></a>00892         <span class="keywordflow">while</span>( !(<a class="code" href="classnrf.html#a6d5e06d2effe8579ac57e5ad648d63e7" title="Retorna o estado do dispositivo.">nrf::get_status</a>() &amp; (<a class="code" href="nordic_8h.html#ab5f5243908a39ffd514fe701e9749bdc">TX_DS</a>|<a class="code" href="nordic_8h.html#ab4482ead4f3b452a032f63ac03ee1870">MAX_RT</a>)) ){
<a name="l00893"></a>00893         }
<a name="l00894"></a>00894     
<a name="l00895"></a>00895         <span class="keywordflow">if</span>(<a class="code" href="classnrf.html#a6d5e06d2effe8579ac57e5ad648d63e7" title="Retorna o estado do dispositivo.">nrf::get_status</a>() &amp; <a class="code" href="nordic_8h.html#ab4482ead4f3b452a032f63ac03ee1870">MAX_RT</a>){
<a name="l00896"></a>00896             <a class="code" href="classnrf.html#a63682fdd6cc605b1cdc576002620c4cb" title="Limpa flag de interrupção.">nrf::clear_int_flag</a>(<a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891a993bd99eb0950eadd9efab50a6ad3826">NRF_MAX_RT</a>);
<a name="l00897"></a>00897             <a class="code" href="classnrf.html#a89449d9aadc1957b3f6631780822f8be" title="Descarrega buffer de transmissão.">nrf::flush_tx_fifo</a>();
<a name="l00898"></a>00898             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00899"></a>00899         }
<a name="l00900"></a>00900         <a class="code" href="classnrf.html#a63682fdd6cc605b1cdc576002620c4cb" title="Limpa flag de interrupção.">nrf::clear_int_flag</a>(<a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891ade79c0fb1841ecbb129802239980b4c2">NRF_TX_DS</a>);
<a name="l00901"></a>00901     }<span class="keywordflow">while</span>(!(<a class="code" href="classnrf.html#a0904f4978e6cbeb63c8a393f1ee9299f" title="Retorna o estado dos buffers de recepção e transmissão.">nrf::get_fifo_status</a>() &amp; <a class="code" href="nordic_8h.html#ae4034d6a21b6646c8710d09e43bd9383">TX_EMPTY</a>));
<a name="l00902"></a>00902     
<a name="l00903"></a>00903     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00904"></a>00904 }
<a name="l00905"></a>00905 
<a name="l00912"></a><a class="code" href="classnrf.html#a8314f44f01b6be582544289d90dce593">00912</a> uint8_t <a class="code" href="classnrf.html#a8314f44f01b6be582544289d90dce593" title="Retorna o tamanho do payload recebido.">nrf::get_received_payload_width</a>(<span class="keywordtype">void</span>){
<a name="l00913"></a>00913     uint8_t buff[2];
<a name="l00914"></a>00914     buff[0] = R_RX_PL_WID;
<a name="l00915"></a>00915     <a class="code" href="spidrv_8cpp.html#a26f7efb34a3460dcb633fa4ae661924b">spi_transfer</a>(<a class="code" href="classnrf.html#ad443b29d8052651f6c64ae972a2e4711">_csn</a>, buff, <span class="keyword">sizeof</span>(buff));
<a name="l00916"></a>00916     <span class="keywordflow">return</span> buff[1];
<a name="l00917"></a>00917 }
<a name="l00918"></a>00918 
<a name="l00926"></a><a class="code" href="classnrf.html#ac3589416cad9c84f46ce5a279fb91835">00926</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#ac3589416cad9c84f46ce5a279fb91835" title="Configura Interrupção externa (IRQ).">nrf::set_irq_pin</a>(uint8_t irq){
<a name="l00927"></a>00927     <a class="code" href="classnrf.html#ad81dc460edeb474b4149f3e26dbe2ede">_irq</a> = irq;
<a name="l00928"></a>00928     pinMode(<a class="code" href="classnrf.html#ad81dc460edeb474b4149f3e26dbe2ede">_irq</a>,INPUT);
<a name="l00929"></a>00929 }
<a name="l00930"></a>00930 
<a name="l00943"></a><a class="code" href="classnrf.html#a9f7f4020061591ecd91e07c0bbd30033">00943</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a9f7f4020061591ecd91e07c0bbd30033" title="Configura a fonte de interrupção.">nrf::set_int_source</a>(<a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891">nrf_int_source_t</a> int_source, <span class="keywordtype">bool</span> enable){
<a name="l00944"></a>00944     uint8_t config;
<a name="l00945"></a>00945     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>,&amp;config);
<a name="l00946"></a>00946     <span class="keywordflow">switch</span>(int_source){
<a name="l00947"></a>00947         <span class="keywordflow">case</span> (<a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891a384b31f70629e7a887970b8750e603e8">NRF_RX_DR</a>):
<a name="l00948"></a>00948         <span class="keywordflow">if</span>(enable){
<a name="l00949"></a>00949             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, config &amp; ~<a class="code" href="nordic_8h.html#a5f30d66a7a448dc83fd695dbd3efbe31">MASK_RX_DR</a>);
<a name="l00950"></a>00950         }<span class="keywordflow">else</span>{
<a name="l00951"></a>00951             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, config | <a class="code" href="nordic_8h.html#a5f30d66a7a448dc83fd695dbd3efbe31">MASK_RX_DR</a>);
<a name="l00952"></a>00952         }
<a name="l00953"></a>00953         <span class="keywordflow">break</span>;
<a name="l00954"></a>00954         <span class="keywordflow">case</span> (<a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891ade79c0fb1841ecbb129802239980b4c2">NRF_TX_DS</a>):
<a name="l00955"></a>00955         <span class="keywordflow">if</span>(enable){
<a name="l00956"></a>00956             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, config &amp; ~<a class="code" href="nordic_8h.html#ad5f819a0030605463504bd2599579b4c">MASK_TX_DS</a>);
<a name="l00957"></a>00957         }<span class="keywordflow">else</span>{
<a name="l00958"></a>00958             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, config | <a class="code" href="nordic_8h.html#ad5f819a0030605463504bd2599579b4c">MASK_TX_DS</a>);
<a name="l00959"></a>00959         }
<a name="l00960"></a>00960         <span class="keywordflow">break</span>;
<a name="l00961"></a>00961         <span class="keywordflow">case</span> (<a class="code" href="nrf_8h.html#afd588f979a21037e3be3c29757dee891a993bd99eb0950eadd9efab50a6ad3826">NRF_MAX_RT</a>):
<a name="l00962"></a>00962         <span class="keywordflow">if</span>(enable){
<a name="l00963"></a>00963             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, config &amp; ~<a class="code" href="nordic_8h.html#a13e9f541027a36c23211d6c8f3b33a92">MASK_MAX_RT</a>);
<a name="l00964"></a>00964         }<span class="keywordflow">else</span>{
<a name="l00965"></a>00965             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#a76ea3cf49247a07c54b3db005a3c7f57">CONFIG</a>, config | <a class="code" href="nordic_8h.html#a13e9f541027a36c23211d6c8f3b33a92">MASK_MAX_RT</a>);
<a name="l00966"></a>00966         }
<a name="l00967"></a>00967     }
<a name="l00968"></a>00968 }
<a name="l00969"></a>00969 
<a name="l00978"></a><a class="code" href="classnrf.html#a7747438ae4e4b1958f1fb6fc138abd92">00978</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a7747438ae4e4b1958f1fb6fc138abd92" title="Configura o payload dinâmico.">nrf::set_dynamic_payload</a>(<a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4">nrf_address_t</a> pipe, <span class="keywordtype">boolean</span> dyn_pl){
<a name="l00979"></a>00979     uint8_t last_value;
<a name="l00980"></a>00980     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ae79cde384e0b6a5549efb001589a79ec">DYNPD</a>,&amp;last_value);
<a name="l00981"></a>00981     <span class="keywordflow">switch</span>(pipe){
<a name="l00982"></a>00982         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4abaeb8791fe0342cade8db09107b1aed0">NRF_PIPE0</a>:
<a name="l00983"></a>00983         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4a1fae01fbfff1b88562ba4aae2ac8c9cf">NRF_PIPE1</a>:
<a name="l00984"></a>00984         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4af7db4e291ec2c6c15060cc5426b92eba">NRF_PIPE2</a>:
<a name="l00985"></a>00985         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4a919be87ccfa5209894438c2cc1b9bcd9">NRF_PIPE3</a>:
<a name="l00986"></a>00986         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4ab7495b387ec5cb15aaab4a331a0c69c4">NRF_PIPE4</a>:
<a name="l00987"></a>00987         <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#ae225b55c2ff0bbaa3661eaa9c8f33aa4a99787dedcb3526eb415f244952205339">NRF_PIPE5</a>:
<a name="l00988"></a>00988         
<a name="l00989"></a>00989         <span class="keywordflow">if</span>(dyn_pl){
<a name="l00990"></a>00990             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#ae79cde384e0b6a5549efb001589a79ec">DYNPD</a>, last_value | <a class="code" href="nordic_8h.html#a83ee7fd3f13e5f09c1285246a3ea2a38">BIT</a>((uint8_t)pipe) );
<a name="l00991"></a>00991         }<span class="keywordflow">else</span>{
<a name="l00992"></a>00992             <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#ae79cde384e0b6a5549efb001589a79ec">DYNPD</a>, last_value &amp; ~<a class="code" href="nordic_8h.html#a83ee7fd3f13e5f09c1285246a3ea2a38">BIT</a>((uint8_t)pipe) );
<a name="l00993"></a>00993         }
<a name="l00994"></a>00994     }
<a name="l00995"></a>00995     
<a name="l00996"></a>00996     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#ae79cde384e0b6a5549efb001589a79ec">DYNPD</a>,&amp;last_value);
<a name="l00997"></a>00997     uint8_t feature;
<a name="l00998"></a>00998     <a class="code" href="classnrf.html#adc8432f57f8406debc6d648daa85de53" title="Lê o conteúdo de um registrador.">nrf::spi_read_register</a>(<a class="code" href="nordic_8h.html#adf81f7b30b6c08465ce704956b446a2d">FEATURE</a>, &amp;feature);
<a name="l00999"></a>00999     <span class="keywordflow">if</span>(last_value){
<a name="l01000"></a>01000         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#adf81f7b30b6c08465ce704956b446a2d">FEATURE</a>, feature|<a class="code" href="nordic_8h.html#a1b46f8336bda068b0759f70cceec3b65">EN_DPL</a>);
<a name="l01001"></a>01001     }<span class="keywordflow">else</span>{
<a name="l01002"></a>01002         <a class="code" href="classnrf.html#a935b975d34e9739d53c040db335faa59" title="Escreve um valor no registrador.">nrf::spi_write_register</a>(<a class="code" href="nordic_8h.html#adf81f7b30b6c08465ce704956b446a2d">FEATURE</a>, feature &amp; ~<a class="code" href="nordic_8h.html#a1b46f8336bda068b0759f70cceec3b65">EN_DPL</a>);
<a name="l01003"></a>01003     }
<a name="l01004"></a>01004 }
<a name="l01005"></a>01005 
<a name="l01020"></a><a class="code" href="classnrf.html#a06b19f760bcb97e16ae843401db93b10">01020</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a06b19f760bcb97e16ae843401db93b10" title="Configura o modo de operação do dispositivo.">nrf::set_mode</a>(<a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13f">nrf_operation_mode_t</a> mode){
<a name="l01021"></a>01021     <a class="code" href="classnrf.html#a507bd00d0183aaca131e672fdeabf073">_last_mode</a> = <a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a>;
<a name="l01022"></a>01022      
<a name="l01023"></a>01023     <span class="keywordflow">switch</span>(mode){
<a name="l01024"></a>01024     
<a name="l01025"></a>01025     <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13fa5faf80fb9a04b5744294ce86cfff7a9d">NRF_POWER_DOWN</a>:
<a name="l01026"></a>01026     <a class="code" href="classnrf.html#a0093820dc7978c8cb33ea250e8847705" title="Desabilita o dispositivo.">nrf::chip_disable</a>();
<a name="l01027"></a>01027     <a class="code" href="classnrf.html#a6568bbc3dab2410df222e1247b4b87d5" title="Configura o modo de potência do dispositivo.">nrf::set_power_up</a>(<span class="keyword">false</span>);
<a name="l01028"></a>01028     <a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> = NRF_POWER_DOWN;
<a name="l01029"></a>01029     <span class="keywordflow">break</span>;
<a name="l01030"></a>01030     
<a name="l01031"></a>01031     <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13faf2fd855adec4f6554dad638a448b7428">NRF_STANDBY</a>:
<a name="l01032"></a>01032     <a class="code" href="classnrf.html#a0093820dc7978c8cb33ea250e8847705" title="Desabilita o dispositivo.">nrf::chip_disable</a>();
<a name="l01033"></a>01033     <a class="code" href="classnrf.html#a6568bbc3dab2410df222e1247b4b87d5" title="Configura o modo de potência do dispositivo.">nrf::set_power_up</a>(<span class="keyword">true</span>);
<a name="l01034"></a>01034     <span class="keywordflow">if</span>(<a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> == <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13fa5faf80fb9a04b5744294ce86cfff7a9d">NRF_POWER_DOWN</a>)
<a name="l01035"></a>01035         delay(5);
<a name="l01036"></a>01036     <a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> = NRF_STANDBY;
<a name="l01037"></a>01037     <span class="keywordflow">break</span>;
<a name="l01038"></a>01038     
<a name="l01039"></a>01039     <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13fa6ba0978740f5af9e322dc373f461eba2">NRF_RX_MODE</a>:
<a name="l01040"></a>01040     <a class="code" href="classnrf.html#a0093820dc7978c8cb33ea250e8847705" title="Desabilita o dispositivo.">nrf::chip_disable</a>();
<a name="l01041"></a>01041     <a class="code" href="classnrf.html#a6568bbc3dab2410df222e1247b4b87d5" title="Configura o modo de potência do dispositivo.">nrf::set_power_up</a>(<span class="keyword">true</span>);
<a name="l01042"></a>01042     <a class="code" href="classnrf.html#a833792eb23819e3b9c7765ad41e38578" title="Configura o modo primário do dispositivo.">nrf::set_primary_rx</a>(<span class="keyword">true</span>);
<a name="l01043"></a>01043     <a class="code" href="classnrf.html#a27c13335cdcd46659337e232f97f663c" title="Habilita o dispositivo.">nrf::chip_enable</a>();
<a name="l01044"></a>01044     <span class="keywordflow">if</span>(<a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> == <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13faf2fd855adec4f6554dad638a448b7428">NRF_STANDBY</a>)
<a name="l01045"></a>01045         delayMicroseconds(150);
<a name="l01046"></a>01046     <span class="keywordflow">if</span>(<a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> == <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13fa5faf80fb9a04b5744294ce86cfff7a9d">NRF_POWER_DOWN</a>)
<a name="l01047"></a>01047         delay(5);
<a name="l01048"></a>01048     <a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> = NRF_RX_MODE;
<a name="l01049"></a>01049     <span class="keywordflow">break</span>;
<a name="l01050"></a>01050     
<a name="l01051"></a>01051     <span class="keywordflow">case</span> <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13faccfe80dc5a511c6fb03f97160465145c">NRF_TX_MODE</a>:
<a name="l01052"></a>01052     <a class="code" href="classnrf.html#a0093820dc7978c8cb33ea250e8847705" title="Desabilita o dispositivo.">nrf::chip_disable</a>();
<a name="l01053"></a>01053     <a class="code" href="classnrf.html#a6568bbc3dab2410df222e1247b4b87d5" title="Configura o modo de potência do dispositivo.">nrf::set_power_up</a>(<span class="keyword">true</span>);
<a name="l01054"></a>01054     <a class="code" href="classnrf.html#a833792eb23819e3b9c7765ad41e38578" title="Configura o modo primário do dispositivo.">nrf::set_primary_rx</a>(<span class="keyword">false</span>);
<a name="l01055"></a>01055     <a class="code" href="classnrf.html#a27c13335cdcd46659337e232f97f663c" title="Habilita o dispositivo.">nrf::chip_enable</a>();
<a name="l01056"></a>01056     <span class="keywordflow">if</span>(<a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> == <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13faf2fd855adec4f6554dad638a448b7428">NRF_STANDBY</a>)
<a name="l01057"></a>01057         delayMicroseconds(150);
<a name="l01058"></a>01058     <span class="keywordflow">if</span>(<a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> == <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13fa5faf80fb9a04b5744294ce86cfff7a9d">NRF_POWER_DOWN</a>)
<a name="l01059"></a>01059         delay(5);
<a name="l01060"></a>01060     <a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a> = NRF_TX_MODE;
<a name="l01061"></a>01061     
<a name="l01062"></a>01062     }
<a name="l01063"></a>01063 }
<a name="l01064"></a>01064 
<a name="l01069"></a><a class="code" href="classnrf.html#a79f6b000ebbba48ea5b9f7d6af5d0738">01069</a> <a class="code" href="nrf_8h.html#a17a9966e8563a86f23ceaf26eca0f13f">nrf_operation_mode_t</a> <a class="code" href="classnrf.html#a79f6b000ebbba48ea5b9f7d6af5d0738" title="Retorna o modo de operação corrente.">nrf::get_current_mode</a>(){
<a name="l01070"></a>01070     <span class="keywordflow">return</span> <a class="code" href="classnrf.html#ad9dd481283b1352ba3a9d6c8a51b9d9b">_current_mode</a>;
<a name="l01071"></a>01071 }
<a name="l01072"></a>01072 
<a name="l01077"></a><a class="code" href="classnrf.html#a87fe38db9329782914ef1ab204223079">01077</a> <span class="keywordtype">void</span> <a class="code" href="classnrf.html#a87fe38db9329782914ef1ab204223079" title="Coloca o dispositivo no modo de operação anterior.">nrf::retrieve_last_mode</a>(){
<a name="l01078"></a>01078     <a class="code" href="classnrf.html#a06b19f760bcb97e16ae843401db93b10" title="Configura o modo de operação do dispositivo.">nrf::set_mode</a>(<a class="code" href="classnrf.html#a507bd00d0183aaca131e672fdeabf073">_last_mode</a>);
<a name="l01079"></a>01079 }
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>Tudo</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Ficheiros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Funções</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variáveis</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Enumerações</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Valores da enumeração</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Gerado em Fri Dec 27 2013 22:19:48 para nrf por&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
